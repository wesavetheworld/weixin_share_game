if("undefined"==typeof Zepto)throw new Error("Parallax.js's script requires Zepto");!function(a){"use strict";function b(){w.loading?a(".wrapper").append('<div class="parallax-loading"><i class="ui-loading ui-loading-white"></i></div>'):y=!1,p=0,o="stay",q=u.length,r=a(window).width(),s=a(window).height(),v=a("[data-animation]");for(var b=0;q>b;b++)a(u[b]).attr("data-id",b+1);t.addClass(w.direction).addClass(w.swipeAnim),u.css({width:r+"px",height:s+"px"}),"horizontal"===w.direction?t.css("width",r*u.length):t.css("height",s*u.length),"cover"===w.swipeAnim&&(t.css({width:r,height:s}),u[0].style.display="block"),w.loading||(a(u[p]).addClass("current"),w.onchange(p,u[p],o),j())}function c(a){return y===!0?(event.preventDefault(),!1):(x=!0,k="horizontal"===w.direction?a.pageX:a.pageY,"default"===w.swipeAnim&&(t.addClass("drag"),n=t.css("-webkit-transform").replace("matrix(","").replace(")","").split(","),n=parseInt("horizontal"===w.direction?n[4]:n[5])),"cover"===w.swipeAnim&&w.drag&&u.addClass("drag"),void(m=1))}function d(a){return y===!0||x===!1?(event.preventDefault(),!1):(event.preventDefault(),l="horizontal"===w.direction?a.pageX:a.pageY,h(),w.drag&&!i()&&f(),void(m=2))}function e(b){y===!0||2!==m||(x=!1,l="horizontal"===w.direction?b.pageX:b.pageY,"default"!==w.swipeAnim||i()?"cover"!==w.swipeAnim||i()||(Math.abs(l-k)<=50&&l>=k&&w.drag?(g(p,"keep-backward"),o="stay"):Math.abs(l-k)<=50&&k>l&&w.drag?(g(p,"keep-forward"),o="stay"):Math.abs(l-k)>50&&l>=k&&w.drag?(g(p-1,"backward"),o="backward"):Math.abs(l-k)>50&&k>l&&w.drag?(g(p+1,"forward"),o="forward"):Math.abs(l-k)>50&&l>=k&&!w.drag?(g(p-1,"backward"),o="backward"):Math.abs(l-k)>50&&k>l&&!w.drag&&(g(p+1,"forward"),o="forward")):(t.removeClass("drag"),Math.abs(l-k)<=50?(g(p),o="stay"):l>=k?(g(p-1),o="backward"):k>l&&(g(p+1),o="forward")),w.indicator&&a(a(".parallax-h-indicator ul li, .parallax-v-indicator ul li").removeClass("current").get(p)).addClass("current"),m=3)}function f(){if("default"===w.swipeAnim){var b=n+l-k;"horizontal"===w.direction?t.css("-webkit-transform","matrix(1, 0, 0, 1, "+b+", 0)"):t.css("-webkit-transform","matrix(1, 0, 0, 1, 0, "+b+")")}else if("cover"===w.swipeAnim){var b=l-k,c=a(u[p-1]),d=a(u[p+1]);a(u).css({"z-index":0}),"horizontal"===w.direction&&l>=k?c.css({"z-index":2,display:"block","-webkit-transform":"translateX("+(b-r)+"px)"}):"horizontal"===w.direction&&k>l?d.css({"z-index":2,display:"block","-webkit-transform":"translateX("+(r+b)+"px)"}):"vertical"===w.direction&&l>=k?c.css({"z-index":2,display:"block","-webkit-transform":"translateY("+(b-s)+"px)"}):"vertical"===w.direction&&k>l&&d.css({"z-index":2,display:"block","-webkit-transform":"translateY("+(s+b)+"px)"})}}function g(b,c){if(p=b,"default"===w.swipeAnim){var d=0;d="horizontal"===w.direction?b*-r:b*-s,t.css("horizontal"===w.direction?{"-webkit-transform":"matrix(1, 0, 0, 1, "+d+", 0)"}:{"-webkit-transform":"matrix(1, 0, 0, 1, 0, "+d+")"})}else"cover"===w.swipeAnim&&("keep-backward"===c&&w.drag?(u.removeClass("drag"),a(u[p-1]).css("horizontal"===w.direction?{"-webkit-transform":"translateX(-100%)"}:{"-webkit-transform":"translateY(-100%)"})):"keep-forward"===c&&w.drag?(u.removeClass("drag"),a(u[p+1]).css("horizontal"===w.direction?{"-webkit-transform":"translateX(100%)"}:{"-webkit-transform":"translateY(100%)"})):"forward"===c&&w.drag?(u.removeClass("drag"),a(u[p-1]).addClass("back"),u[p].style.webkitTransform="translate(0, 0)"):"backward"===c&&w.drag?(u.removeClass("drag"),a(u[p+1]).addClass("back"),u[p].style.webkitTransform="translate(0, 0)"):"forward"!==c||w.drag?"backward"!==c||w.drag||(t.addClass("animate"),a(u[p+1]).addClass("back"),a(u[p]).addClass("front").show()):(t.addClass("animate"),a(u[p-1]).addClass("back"),a(u[p]).addClass("front").show()));y=!0,setTimeout(function(){y=!1},300)}function h(){"horizontal"===w.direction?l>=k?t.removeClass("forward").addClass("backward"):k>l&&t.removeClass("backward").addClass("forward"):l>=k?t.removeClass("forward").addClass("backward"):k>l&&t.removeClass("backward").addClass("forward")}function i(){if("horizontal"===w.direction){if(l>=k&&0===p||k>=l&&p===q-1)return!0}else if(l>=k&&0===p||k>=l&&p===q-1)return!0;return!1}function j(){v.css({"-webkit-animation":"none"}),a(".current [data-animation]").each(function(b,c){var d=a(c),e=d.attr("data-animation"),f=d.attr("data-duration")||500,g=d.attr("data-timing-function")||"ease",h=d.attr("data-delay")?d.attr("data-delay"):0;"followSlide"===e&&("horizontal"===w.direction&&"forward"===o?e="followSlideToLeft":"horizontal"===w.direction&&"backward"===o?e="followSlideToRight":"vertical"===w.direction&&"forward"===o?e="followSlideToTop":"vertical"===w.direction&&"backward"===o&&(e="followSlideToBottom")),d.css({"-webkit-animation":e+" "+f+"ms "+g+" "+h+"ms both",animation:e+" "+f+"ms "+g+" "+h+"ms both"})})}var k,l,m,n,o,p,q,r,s,t,u,v,w,x=!1,y=!0;a.fn.parallax=function(c){return w=a.extend({},a.fn.parallax.defaults,c),this.each(function(){t=a(this),u=t.find(".page"),b()})},a.fn.parallax.defaults={direction:"vertical",swipeAnim:"default",drag:!0,loading:!1,indicator:!1,arrow:!1,onchange:function(){},orientationchange:function(){}},a(document).on("touchstart",".page",function(a){c(a.changedTouches[0])}).on("touchmove",".page",function(a){d(a.changedTouches[0])}).on("touchend",".page",function(a){e(a.changedTouches[0])}).on("webkitAnimationEnd webkitTransitionEnd",".pages",function(){"stay"!==o&&(setTimeout(function(){a(".back").hide().removeClass("back"),a(".front").show().removeClass("front"),t.removeClass("forward backward animate")},10),a(u.removeClass("current").get(p)).addClass("current"),w.onchange(p,u[p],o),j())}),a(".page *").on("webkitAnimationEnd",function(){event.stopPropagation()}),a(window).on("load",function(){if(w.loading&&(a(".parallax-loading").remove(),y=!1,a(u[p]).addClass("current"),w.onchange(p,u[p],o),j()),w.indicator){y=!1;var b="horizontal"===w.direction?"parallax-h-indicator":"parallax-v-indicator";a(".wrapper").append("<div class="+b+"></div>");for(var c="<ul>",d=1;q>=d;d++)c+=1===d?'<li class="current">'+d+"</li>":"<li>"+d+"</li>";c+="</ul>",a("."+b).append(c)}w.arrow&&(u.append('<span class="parallax-arrow"></span>'),a(u[q-1]).find(".parallax-arrow").remove())}),window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){(180===window.orientation||0===window.orientation)&&w.orientationchange("portrait"),(90===window.orientation||-90===window.orientation)&&w.orientationchange("landscape")},!1)}(Zepto);